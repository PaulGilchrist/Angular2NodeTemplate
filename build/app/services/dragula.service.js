"use strict";var __decorate=this&&this.__decorate||function(e,t,r,n){var o,i=arguments.length,a=i<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,r,n);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(a=(i<3?o(a):i>3?o(t,r,a):o(t,r))||a);return i>3&&a&&Object.defineProperty(t,r,a),a},__metadata=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},core_1=require("@angular/core"),DragulaService=function(){function e(){this.cancel=new core_1.EventEmitter,this.cloned=new core_1.EventEmitter,this.drag=new core_1.EventEmitter,this.dragend=new core_1.EventEmitter,this.drop=new core_1.EventEmitter,this.out=new core_1.EventEmitter,this.over=new core_1.EventEmitter,this.remove=new core_1.EventEmitter,this.shadow=new core_1.EventEmitter,this.dropModel=new core_1.EventEmitter,this.removeModel=new core_1.EventEmitter,this.events=["cancel","cloned","drag","dragend","drop","out","over","remove","shadow","dropModel","removeModel"],this.bags=[]}return e.prototype.add=function(e,t){var r=this.find(e);if(r)throw new Error('Bag named: "'+e+'" already exists.');return r={name:e,drake:t},this.bags.push(r),t.models&&this.handleModels(e,t),r.initEvents||this.setupEvents(r),r},e.prototype.find=function(e){for(var t=0;t<this.bags.length;t++)if(this.bags[t].name===e)return this.bags[t]},e.prototype.destroy=function(e){var t=this.find(e),r=this.bags.indexOf(t);this.bags.splice(r,1),t.drake.destroy()},e.prototype.setOptions=function(e,t){var r=this.add(e,dragula(t));this.handleModels(e,r.drake)},e.prototype.handleModels=function(e,t){var r,n,o,i,a=this;t.on("remove",function(r,o){t.models&&(i=t.models[t.containers.indexOf(o)],i.splice(n,1),a.removeModel.emit([e,r,o]))}),t.on("drag",function(e,t){r=e,n=a.domIndexOf(e,t)}),t.on("drop",function(s,d,c){if(t.models&&d){if(o=a.domIndexOf(s,d),i=t.models[t.containers.indexOf(c)],d===c)i.splice(o,0,i.splice(n,1)[0]);else{var l=r===s,f=t.models[t.containers.indexOf(d)],h=l?i[n]:JSON.parse(JSON.stringify(i[n]));l&&i.splice(n,1),f.splice(o,0,h),d.removeChild(s)}a.dropModel.emit([e,s,d,c])}})},e.prototype.setupEvents=function(e){e.initEvents=!0;var t=this,r=function(r){function n(){var n=Array.prototype.slice.call(arguments);t[r].emit([e.name].concat(n))}e.drake.on(r,n)};this.events.forEach(r)},e.prototype.domIndexOf=function(e,t){return Array.prototype.indexOf.call(t.children,e)},e=__decorate([core_1.Injectable(),__metadata("design:paramtypes",[])],e)}();exports.DragulaService=DragulaService;